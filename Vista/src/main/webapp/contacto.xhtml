<?xml version='1.0' encoding='UTF-8' ?>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>EVENTOS CAMPESTRE — Contacto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/primeicons@6.0.1/primeicons.css"/>

    <style type="text/css">
        /*<![CDATA[*/
        :root { --olive: #3f4737; --paper: #ffffff; --ink: #1d1d1b; --muted: #c5c8c0; --beige: #e8dfd3; --black: #0d0d0d; --white: #ffffff; --brown-lines: #9c8e80; --lightGray-bg: #c5c7c8; }
        * { box-sizing: border-box; }
        html, body { height: 100%; }
        body { margin: 0; font-family: "Minerva Modern", serif; color: var(--ink); background: var(--paper); padding-top: 110px; }
        .layout { min-height: 100vh; display: flex; flex-direction: column; }

        /* TOPBAR */
        .topbar { background-color: var(--olive); color: var(--white); padding: 15px 40px 10px 40px; display: flex; flex-direction: column; position: fixed; top: 0; left: 0; right: 0; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.15); transition: padding 0.25s ease, box-shadow 0.25s ease; }
        .tb-row1 { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; }
        .tb-left { display: flex; gap: 15px; align-items: center; }
        .tb-left i { font-size: 1.2rem; color: var(--white); opacity: 0.9; cursor: pointer; }
        .tb-left a { color: var(--white); text-decoration: none; opacity: 0.9; display: flex; align-items: center; }
        .tb-left a:hover { opacity: 1; }
        .tb-brand { text-align: center; font-style: italic; font-weight: 400; font-size: 2rem; letter-spacing: 0.05em; transition: font-size 0.25s ease; }
        .tb-brand a { color: var(--white); text-decoration: none; }
        .tb-right { display: flex; justify-content: flex-end; align-items: center; gap: 10px; }
        .tb-count { font-size: 1.15rem; font-style: italic; font-weight: 700; letter-spacing: 0.05em; }
        .tb-row2 { display: flex; justify-content: center; gap: 60px; margin-top: 15px; font-style: italic; font-size: 1.1rem; transition: margin-top 0.25s ease, gap 0.25s ease, font-size 0.25s ease; }
        .tb-row2 a { color: var(--white); text-decoration: none; opacity: 0.9; }
        .tb-row2 a:hover { opacity:1; text-decoration:underline; }
        .topbar.topbar--shrink { padding: 6px 30px 4px 30px; box-shadow: 0 3px 10px rgba(0,0,0,0.25); }
        .topbar.topbar--shrink .tb-brand { font-size: 1.5rem; }
        .topbar.topbar--shrink .tb-row2 { margin-top: 6px; gap: 40px; font-size: 1rem; }

        /* Estilos Contacto */
        .contact-container { max-width: 1200px; margin: 0 auto; padding: 60px 20px; width: 100%; }
        .contact-grid { display: grid; grid-template-columns: 300px 1fr; gap: 80px; }
        .c-left h1 { font-size: 2.2rem; margin-top: 0; margin-bottom: 30px; font-weight: 400; letter-spacing: 0.05em; }
        .c-left p { font-size: 1rem; line-height: 1.5; margin-bottom: 20px; font-family: sans-serif; }
        .form-row { display: flex; gap: 30px; margin-bottom: 25px; }
        .form-col { flex: 1; }
        .lbl { display: block; font-weight: bold; margin-bottom: 8px; font-size: 0.9rem; font-family: sans-serif; }
        .ui-inputtext, .ui-inputtextarea { width: 100%; border-radius: 0 !important; border: 1px solid #ddd !important; padding: 10px !important; background: #fff !important; box-shadow: none !important; }
        .ui-inputtext:focus, .ui-inputtextarea:focus { border-color: #999 !important; }
        .btn-black { background: #000 !important; border: 1px solid #000 !important; color: #fff !important; border-radius: 0 !important; padding: 8px 30px !important; text-transform: uppercase; font-weight: bold !important; margin-top: 10px; }
        .btn-black:hover { background: #333 !important; }
        .cta-btn{ background:#000 !important; border:1px solid #000 !important; color:#fff !important; }

        /* Footer */
        .footer { background: var(--olive); color: #e9eadf; display: grid; grid-template-columns: 1fr auto 1fr; gap: 26px; align-items: center; padding: 22px 18px; margin-top: auto; }
        .footer__right { text-align: right; }

        /* Modal Carrito */
        .custom-cart-modal.ui-dialog { position: fixed !important; top: 75px !important; right: 40px !important; left: auto !important; box-shadow: 0 5px 30px rgba(0,0,0,0.15) !important; z-index: 1001 !important; }
        .ui-dialog .ui-dialog-titlebar { background-color: var(--olive) !important; color: var(--white) !important; border: none !important; padding: 10px 15px !important; }
        .ui-dialog .ui-dialog-content { background-color: var(--beige) !important; padding: 0 !important; color: var(--black); }
        .modal-cart-content { padding: 15px 20px; }
        .modal-item-row { display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--brown-lines); gap: 10px; }
        .modal-btn-remove { color: var(--black); opacity: 0.6; text-decoration: none; }
        .modal-item-img { width: 40px; height: 40px; object-fit: cover; border: 1px solid #ccc; }
        .modal-item-name { flex: 1; font-weight: 600; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .modal-qty-selector { display: flex; align-items: center; background-color: var(--lightGray-bg); border: 1px solid var(--black); padding: 2px 5px; gap: 8px; }
        .modal-qty-selector .ui-inputnumber input { background: transparent !important; border: none !important; width: 40px !important; text-align: center; }
        .modal-item-price { font-weight: 600; min-width: 60px; text-align: right; font-size: 0.95rem; }

        @media (max-width: 800px) {
            .contact-grid { grid-template-columns: 1fr; gap: 40px; }
            .form-row { flex-direction: column; gap: 15px; }
            .footer { grid-template-columns: 1fr; }
            .footer__right { text-align: center; }
        }

        /* Errores de validación */
        .error-msg {
            color: #b00020;
            font-size: 0.8rem;
            margin-top: 4px;
            font-family: sans-serif;
        }

        .ui-inputfield.ui-state-error,
        .ui-inputtextarea.ui-state-error {
            border-color: #b00020 !important;
        }
        /*]]>*/
    </style>

    <script type="text/javascript">
        window.addEventListener('DOMContentLoaded', function () {
            var topbar = document.querySelector('.topbar');
            if (!topbar) return;
            window.addEventListener('scroll', function () {
                if (window.scrollY > 120) {
                    topbar.classList.add('topbar--shrink');
                } else {
                    topbar.classList.remove('topbar--shrink');
                }
            });
        });
    </script>
</h:head>

<h:body>
    <h:form id="formContacto">

        <!-- Growl para mostrar la confirmación que ya manda el bean -->
        <p:growl id="msgs"
                 showDetail="true"
                 life="5000"
                 globalOnly="true" />

        <div class="layout">
            <header class="topbar">
                <div class="tb-row1">
                    <div class="tb-left">
                        <a href="https://www.facebook.com/cositastanbellas?locale=es_LA" class="tb-icon"><i class="pi pi-facebook"/></a>
                        <a href="https://w.app/eventoscampestre" class="tb-icon"><i class="pi pi-whatsapp"/></a>
                        <a href="principal_cliente.xhtml" class="tb-icon" title="Inicio">
                            <i class="pi pi-home"/>
                        </a>
                    </div>
                    <div class="tb-brand">
                        <a href="principal_cliente.xhtml">EVENTOS CAMPESTRE</a>
                    </div>
                    <div class="tb-right">
                        <p:commandLink onclick="PF('carritoModal').show(); return false;"
                                       style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 5px; cursor: pointer%;">
                            <i class="pi pi-shopping-cart" style="font-size: 1.4rem;"/>
                            <h:panelGroup id="tb-count-group">
                                <span class="tb-count">#{carritoBean.carrito.conteoTotalItems}</span>
                            </h:panelGroup>
                        </p:commandLink>
                    </div>
                </div>
                <nav class="tb-row2">
                    <a href="acercaDe.xhtml">Acerca de</a>
                    <a href="renta_cliente.xhtml">Renta</a>
                    <a href="contacto.xhtml">Contacto</a>
                </nav>
            </header>

            <div class="contact-container">
                <div class="contact-grid">
                    <div class="c-left">
                        <h1>CONTACTANOS</h1>
                        <p>Si tienes consultas sobre eventos o alguna queja, no dudes en comunicarte con nosotros aquí.</p>
                        <p>Si te gustaría tener alguna atención personalizada para un evento de gran tamaño puedes darnos los detalles aquí.</p>
                    </div>
                    <div class="c-right">
                        <div class="form-row">
                            <div class="form-col">
                                <label class="lbl" for="nombre">Nombre</label>
                                <p:inputText id="nombre"
                                             value="#{contactoBean.nombre}"
                                             required="true"
                                             requiredMessage="Por favor, escribe tu nombre."
                                             validatorMessage="El nombre debe tener entre 2 y 50 caracteres.">
                                    <f:validateLength minimum="2" maximum="50" />
                                </p:inputText>
                                <p:message for="nombre" display="text" styleClass="error-msg" />
                            </div>

                            <div class="form-col">
                                <label class="lbl" for="apellido">Apellido</label>
                                <p:inputText id="apellido"
                                             value="#{contactoBean.apellido}"
                                             required="true"
                                             requiredMessage="Por favor, escribe tu apellido."
                                             validatorMessage="El apellido debe tener entre 2 y 50 caracteres.">
                                    <f:validateLength minimum="2" maximum="50" />
                                </p:inputText>
                                <p:message for="apellido" display="text" styleClass="error-msg" />
                            </div>
                        </div>

                        <div class="form-col" style="margin-bottom:25px;">
                            <label class="lbl" for="correo">Correo electrónico</label>
                            <p:inputText id="correo"
                                         value="#{contactoBean.correo}"
                                         required="true"
                                         requiredMessage="El correo electrónico es obligatorio."
                                         validatorMessage="El correo no tiene un formato válido.">
                                <!-- REGEX CORREGIDA -->
                                <f:validateRegex
                                        pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+[.][A-Za-z]{2,}$" />
                            </p:inputText>
                            <p:message for="correo" display="text" styleClass="error-msg" />
                        </div>

                        <div class="form-col" style="margin-bottom:25px;">
                            <label class="lbl" for="asunto">Asunto</label>
                            <p:inputText id="asunto"
                                         value="#{contactoBean.asunto}"
                                         required="true"
                                         requiredMessage="El asunto es obligatorio."
                                         validatorMessage="El asunto debe tener entre 3 y 100 caracteres.">
                                <f:validateLength minimum="3" maximum="100" />
                            </p:inputText>
                            <p:message for="asunto" display="text" styleClass="error-msg" />
                        </div>

                        <div class="form-col" style="margin-bottom:25px;">
                            <label class="lbl" for="mensaje">Mensaje</label>
                            <p:inputTextarea id="mensaje"
                                             value="#{contactoBean.mensaje}"
                                             rows="6"
                                             required="true"
                                             requiredMessage="Por favor, escribe tu mensaje."
                                             validatorMessage="El mensaje debe tener al menos 10 caracteres.">
                                <f:validateLength minimum="10" maximum="1000" />
                            </p:inputTextarea>
                            <p:message for="mensaje" display="text" styleClass="error-msg" />
                        </div>

                        <p:commandButton value="ENVIAR"
                                         action="#{contactoBean.enviar}"
                                         update="@form msgs"
                                         styleClass="btn-black" />
                    </div>
                </div>
            </div>

            <p:dialog header="Mi carrito"
                      widgetVar="carritoModal"
                      draggable="false"
                      resizable="false"
                      showEffect="fade"
                      hideEffect="fade"
                      styleClass="custom-cart-modal"
                      closeOnEscape="true"
                      responsive="true"
                      width="350">
                <p:ajax event="close" update=":formContacto:tb-count-group" />
                <h:panelGroup id="modalCarritoContent" layout="block" styleClass="modal-cart-content">
                    <p:outputPanel rendered="#{carritoBean.carrito.vacio}"
                                   style="display:block; text-align:center; padding: 20px 0; font-style: italic;">
                        Tu carrito esta vacio.
                    </p:outputPanel>

                    <p:dataList value="#{carritoBean.carrito.items}"
                                var="item"
                                type="none"
                                styleClass="dl-reset"
                                rendered="#{not carritoBean.carrito.vacio}">
                        <div class="modal-item-row">
                            <p:commandLink actionListener="#{carritoBean.eliminarItem(item)}"
                                           update=":formContacto:modalCarritoContent :formContacto:tb-count-group"
                                           styleClass="modal-btn-remove">
                                <i class="pi pi-minus-circle"/>
                            </p:commandLink>

                            <h:graphicImage rendered="#{not empty item.articulo}"
                                            value="#{articuloUI.getImagenBase64(item.articulo)}"
                                            styleClass="modal-item-img"/>

                            <h:outputText value="#{item.articulo.nombre}" styleClass="modal-item-name"/>

                            <div class="modal-qty-selector">
                                <p:commandLink actionListener="#{carritoBean.decrementarCantidad(item)}"
                                               update=":formContacto:modalCarritoContent :formContacto:tb-count-group"
                                               disabled="#{item.cantidad le 1}">
                                    <i class="pi pi-minus" style="font-size: 0.7rem;"/>
                                </p:commandLink>

                                <h:outputText value="#{item.cantidad}"
                                              style="width: 30px; text-align:center; font-weight:bold;"/>

                                <p:commandLink actionListener="#{carritoBean.incrementarCantidad(item)}"
                                               update=":formContacto:modalCarritoContent :formContacto:tb-count-group">
                                    <i class="pi pi-plus" style="font-size: 0.7rem;"/>
                                </p:commandLink>
                            </div>

                            <h:outputText value="#{item.precioTotal}" styleClass="modal-item-price">
                                <f:convertNumber type="currency" currencySymbol="$" maxFractionDigits="0"/>
                            </h:outputText>
                        </div>
                    </p:dataList>

                    <h:panelGroup layout="block"
                                  style="margin-top: 15px; border-top: 2px solid var(--olive); padding-top: 15px;"
                                  rendered="#{not carritoBean.carrito.vacio}">
                        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1rem; margin-bottom: 15px;">
                            <span>Total:</span>
                            <h:outputText value="#{carritoBean.carrito.total}">
                                <f:convertNumber type="currency" currencySymbol="$" maxFractionDigits="0"/>
                            </h:outputText>
                        </div>

                        <p:button value="Ver Carrito Completo"
                                  outcome="/Carrito.xhtml"
                                  styleClass="cta-btn"
                                  style="width: 100%;"/>
                    </h:panelGroup>
                </h:panelGroup>
            </p:dialog>

            <footer class="footer">
                <div class="footer__left">
                    <div class="foot-brand"><i class="pi pi-briefcase"></i> EVENTOS CAMPESTRE</div>
                    <div class="foot-wa">WhatsApp: 6862632183 , 6863120350</div>
                    <div class="foot-copy">Copyright ©MoonSoftware · Todos los derechos reservados.</div>
                </div>
                <div class="footer__center"></div>
                <div class="footer__right">
                    <div class="foot-title">UBICACION</div>
                    <div>Mexicali Baja California<br/>Mexico.</div>
                </div>
            </footer>
        </div>
    </h:form>
</h:body>
</html>
